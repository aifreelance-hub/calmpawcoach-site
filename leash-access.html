<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Leash Plan Access ‚Äî CalmPaw 10-Day Walking Plan</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon" type="image/png" href="favicon.png" />

  <!-- Meta Pixel Code -->
<script>
!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '1537393974017987');
fbq('track', 'PageView');
</script>
<noscript><img height="1" width="1" style="display:none"
src="https://www.facebook.com/tr?id=1537393974017987&ev=PageView&noscript=1"
/></noscript>
<!-- End Meta Pixel Code -->

  <!-- Google tag (gtag.js) ÂíåÂÖ∂‰ªñ access È°µ‰øùÊåÅ‰∏ÄËá¥ -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=AW-17779181109"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag("js", new Date());
    gtag("config", "AW-17779181109");
  </script>

  <style>
    *{box-sizing:border-box;margin:0;padding:0;}
    :root{
      --bg:#fff7f0;--accent:#ffb86b;--accent-strong:#ff914d;
      --text-main:#3b2824;--text-soft:#8a6a63;
      --border-soft:#f3d9c4;--radius-lg:26px;--radius-md:18px;--radius-pill:999px;
      --shadow-soft:0 24px 60px rgba(210,145,110,0.32);
    }
    body{
      font-family:-apple-system,BlinkMacSystemFont,"SF Pro Text",system-ui,"Segoe UI",sans-serif;
      background:
        radial-gradient(circle at 5% 0%, #ffe0c0 0%, transparent 55%),
        radial-gradient(circle at 100% 0%, #ffd4d4 0%, transparent 55%),
        linear-gradient(180deg,#fff7f0 0%,#fff2e7 40%,#fff8f2 100%);
      color:var(--text-main);min-height:100vh;-webkit-font-smoothing:antialiased;
    }
    a{text-decoration:none;color:inherit;}

    header{
      position:sticky;top:0;z-index:50;
      backdrop-filter:blur(18px);
      background:linear-gradient(to bottom,rgba(255,248,240,0.98),rgba(255,248,240,0.9));
      border-bottom:1px solid rgba(243,217,196,0.8);
    }
    .nav-inner{
      max-width:1120px;margin:0 auto;padding:10px 20px;
      display:flex;align-items:center;justify-content:space-between;gap:14px;
      flex-wrap:wrap;
    }
    .brand{display:flex;align-items:center;gap:10px;flex-shrink:0;}
    .brand-logo{
      width:40px;height:40px;border-radius:18px;
      background:radial-gradient(circle at 20% 15%,#fff9f3 0%,#ffb86b 40%,#ff914d 84%);
      display:flex;align-items:center;justify-content:center;
      font-size:22px;box-shadow:0 16px 40px rgba(214,139,86,0.6);
    }
    .brand-text-main{font-weight:750;letter-spacing:.03em;font-size:18px;}
    .brand-text-sub{font-size:11px;color:var(--text-soft);}

    .nav-links{
      display:flex;align-items:center;gap:16px;font-size:14px;color:var(--text-soft);
      flex:1;justify-content:center;min-width:0;
    }
    .nav-links a{
      padding:6px 11px;border-radius:999px;
      transition:background .18s ease,color .18s ease,transform .12s ease;
      white-space:nowrap;
    }
    .nav-links a:hover{
      background:rgba(255,222,186,0.7);color:var(--text-main);transform:translateY(-1px);
    }
    @media(max-width:880px){.nav-links{display:none;}}

    .nav-cta{
      display:flex;align-items:center;gap:10px;
      flex-shrink:0;
    }

    /* È°∂ÈÉ®ÁôªÂΩïÂå∫ÂüüÔºàË∑üÂÖ∂‰ªñ access È°µÁªü‰∏ÄÔºâ */
    .nav-auth{
      display:flex;
      align-items:center;
      gap:6px;
    }
    .nav-auth-email{
      max-width:160px;
      padding:5px 10px;
      border-radius:var(--radius-pill);
      background:rgba(255,250,244,0.95);
      border:1px solid rgba(243,217,196,0.9);
      font-size:12px;
      color:#6b4532;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .nav-auth-btn{
      border:none;
      background:transparent;
      font-size:11px;
      color:#b05825;
      padding:4px 7px;
      border-radius:999px;
      cursor:pointer;
      white-space:nowrap;
      transition:background .15s ease,color .15s ease;
    }
    .nav-auth-btn:hover{
      background:rgba(255,237,213,0.95);
      color:#7a3410;
    }

    .btn-outline{
      padding:7px 14px;border-radius:var(--radius-pill);
      border:1px solid var(--border-soft);font-size:13px;
      background:#fff8f2;color:var(--text-soft);cursor:pointer;
      white-space:nowrap;
      display:inline-flex;
      align-items:center;
      gap:6px;
    }
    .btn-outline:hover{
      border-color:var(--accent);
      color:var(--text-main);
      box-shadow:0 14px 32px rgba(204,145,107,0.28);
      transform:translateY(-1px);
      background:#fffaf5;
    }
    .nav-login-emoji{font-size:14px;}

    @media(max-width:640px){
      .nav-inner{
        padding:10px 14px;
      }
      .brand{
        width:100%;
      }
      .nav-cta{
        width:100%;
        justify-content:flex-end;
        gap:6px;
      }
      .btn-outline{
        padding:6px 10px;
        font-size:12px;
      }
      .nav-auth-email{
        max-width:130px;
        font-size:11px;
      }
    }

    .btn-primary{
      padding:7px 16px;border-radius:var(--radius-pill);border:none;
      font-size:13px;font-weight:600;cursor:pointer;
      background:linear-gradient(135deg,#ffb86b,#ff914d);color:#4a251a;
      box-shadow:0 16px 36px rgba(214,139,86,0.6);
      display:inline-flex;align-items:center;gap:6px;
      white-space:nowrap;
      transition:transform .18s ease, box-shadow .18s ease;
    }
    .btn-primary:hover{transform:translateY(-1px) scale(1.01);}

    main{max-width:1120px;margin:0 auto;padding:24px 20px 40px;}
    .hero{
      display:grid;grid-template-columns:minmax(0,1.5fr) minmax(0,1.1fr);
      gap:22px;margin-bottom:26px;align-items:flex-start;
    }
    @media(max-width:860px){.hero{grid-template-columns:minmax(0,1fr);}}
    .hero-tag{
      display:inline-flex;align-items:center;gap:6px;
      padding:4px 10px;border-radius:999px;
      background:rgba(212,241,255,0.9);font-size:11px;color:#2b6a82;
      margin-bottom:8px;
    }
    .hero-title{font-size:22px;margin-bottom:6px;}
    .hero-sub{font-size:13px;color:var(--text-soft);margin-bottom:10px;max-width:540px;line-height:1.6;}
    .hero-note{
      font-size:11px;color:var(--text-soft);margin-bottom:10px;
      padding:6px 10px;border-radius:var(--radius-pill);
      background:rgba(240,250,255,0.9);display:inline-flex;align-items:center;gap:6px;
    }
    .hero-note span{font-weight:600;color:#2b6a82;}
    .hero-actions{display:flex;flex-wrap:wrap;gap:10px;margin-top:10px;}
    .hero-card{
      border-radius:var(--radius-lg);
      background:rgba(240,250,255,0.96);
      border:1px solid rgba(200,228,245,0.9);
      padding:14px 14px 12px;
      box-shadow:0 16px 34px rgba(167,200,224,0.5);
      font-size:11px;color:#35596f;
    }
    .hero-card h2{font-size:14px;margin-bottom:6px;}
    .hero-card ul{margin-left:14px;margin-bottom:4px;}
    .hero-card li{margin-bottom:4px;}

    .section{margin-bottom:24px;}
    .section h2{font-size:16px;margin-bottom:6px;}
    .section p{font-size:13px;color:var(--text-soft);margin-bottom:6px;line-height:1.6;}

    .days-grid{
      border-radius:18px;
      background:#fffaf5;border:1px solid rgba(243,217,196,0.9);
      padding:12px;font-size:12px;color:var(--text-soft);
    }
    .day-block{margin-bottom:10px;padding-bottom:8px;border-bottom:1px dashed rgba(243,217,196,0.8);}
    .day-block:last-child{border-bottom:none;margin-bottom:0;padding-bottom:0;}
    .day-title-row{display:flex;justify-content:space-between;align-items:center;margin-bottom:2px;}
    .day-title{font-weight:600;color:#2f647b;font-size:13px;}
    .day-time{font-size:11px;color:#547d93;}
    .day-focus{font-size:11px;color:#a36b4b;margin-bottom:4px;}
    .day-steps{margin-left:16px;margin-bottom:4px;}
    .day-steps li{margin-bottom:3px;}
    .day-tip{font-size:11px;color:#9a6b4e;margin-top:3px;}

    .highlight-box{
      border-radius:18px;
      background:rgba(240,250,255,0.96);
      border:1px solid rgba(200,228,245,0.9);
      padding:12px;font-size:12px;color:#35596f;
    }

    /* È°∂ÈÉ®ËÆøÈóÆÁä∂ÊÄÅÊ†∑ÂºèÔºöÂ∞èËèäËä± + ÊàêÂäü / ÈîôËØØ */
    .access-status-row{
      display:flex;
      align-items:flex-start;
      gap:10px;
    }
    .access-spinner{
      width:16px;
      height:16px;
      border-radius:999px;
      border:2px solid rgba(125,211,252,0.3);
      border-top-color:#0ea5e9;
      animation:access-spin .8s linear infinite;
      flex-shrink:0;
      margin-top:2px;
    }
    @keyframes access-spin{
      from{transform:rotate(0deg);}
      to{transform:rotate(360deg);}
    }
    .access-status-ok{
      background:rgba(209,250,229,0.96);
      border-color:rgba(52,211,153,0.7);
      color:#047857;
    }
    .access-status-error{
      background:rgba(254,242,242,0.96);
      border-color:rgba(248,113,113,0.7);
      color:#b91c1c;
    }

    footer{
      border-top:1px solid rgba(243,217,196,0.8);
      background:rgba(255,248,241,0.96);margin-top:10px;
    }
    .footer-inner{
      max-width:1120px;margin:0 auto;
      padding:12px 20px 16px;
      display:flex;flex-wrap:wrap;gap:8px;justify-content:space-between;
      font-size:11px;color:var(--text-soft);
    }
    .footer-links{display:flex;gap:12px;flex-wrap:wrap;}
    .footer-links a:hover{color:#b05825;}

    @media(max-width:640px){
      .footer-inner{
        padding:10px 14px 14px;
        font-size:10px;
      }
      .footer-links{
        gap:10px;
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="nav-inner">
      <a href="index.html" class="brand">
        <div class="brand-logo">üêæ</div>
        <div>
          <div class="brand-text-main">CalmPaw Coach</div>
          <div class="brand-text-sub">Gentle, realistic dog training</div>
        </div>
      </a>
      <nav class="nav-links">
        <a href="programs.html">Programs</a>
        <a href="bundle.html">Complete Pack</a>
        <a href="ai.html">Ask a Dog Trainer ‚Äî AI Unlimited</a>
      </nav>
      <div class="nav-cta">
        <!-- È°∂ÈÉ®ÁôªÂΩïÁä∂ÊÄÅÂå∫Âüü -->
        <div id="nav-auth-area">
          <a class="btn-outline" href="auth.html?redirect=/leash-access.html">
            <span class="nav-login-emoji">üîë</span> Log in
          </a>
        </div>
      </div>
    </div>
  </header>

  <main>
    <!-- È°∂ÈÉ®ËÆøÈóÆÁä∂ÊÄÅÊèêÁ§∫ -->
    <div id="access-status" class="highlight-box" style="display:none;margin-bottom:16px;"></div>

    <!-- ‰∏ãÈù¢ÊòØÁúüÊ≠£ÂÜÖÂÆπÔºöÁ°ÆËÆ§Êúâ leash ÊùÉÈôêÂêéÂÜçÂ±ïÁ§∫ -->
    <div id="paid-content" style="display:none;">
      <section class="hero">
        <div>
          <div class="hero-tag">Access page ¬∑ 10-day leash plan unlocked</div>
          <h1 class="hero-title">Your 10-Day Leash Walking Plan</h1>
          <p class="hero-sub">
            This page contains your full 10-day structure for calmer, more
            enjoyable walks. You can bookmark it and come back anytime.
          </p>
          <div class="hero-note">
            <span>Tip:</span> keep sessions short. It‚Äôs better to do 5 quality
            minutes than 40 minutes of pulling and frustration.
          </div>
          <div class="hero-actions">
            <a href="bundle.html" class="btn-primary">See Complete Pack ‚Üí</a>
            <a href="programs.html" class="btn-outline">View other programs</a>
          </div>
        </div>

        <div class="hero-card">
          <h2>How to use this plan</h2>
          <ul>
            <li>Choose one or two short sessions per day (5‚Äì15 minutes).</li>
            <li>Practice indoors or in quiet areas first, then build outwards.</li>
            <li>End sessions while your dog is still thinking, not overwhelmed.</li>
          </ul>
          <p style="margin-top:6px;">
            Progress is measured in more moments of slack leash, faster recovery
            from distractions and walks you don‚Äôt dread.
          </p>
        </div>
      </section>

      <section class="section">
        <h2>10-day schedule</h2>
        <div class="days-grid">
          <div class="day-block">
            <div class="day-title-row">
              <div class="day-title">Day 1 ‚Äî Gear & expectations</div>
              <div class="day-time">10‚Äì15 minutes</div>
            </div>
            <div class="day-focus">
              Set up safe equipment and a calm ‚Äúwalk start‚Äù routine.
            </div>
            <ul class="day-steps">
              <li>Choose a well-fitted harness or flat collar and a non-retractable leash.</li>
              <li>Before you clip the leash, wait for a brief moment of calm ‚Äî then clip and praise.</li>
              <li>Practice clipping / unclipping 5‚Äì10 times while rewarding calm, not jumping.</li>
            </ul>
            <div class="day-tip">
              üéØ Goal: Your dog learns that walks begin with a pause, not a launch.
            </div>
          </div>

          <div class="day-block">
            <div class="day-title-row">
              <div class="day-title">Day 2 ‚Äî ‚ÄúCheck-in‚Äù indoors</div>
              <div class="day-time">10 minutes</div>
            </div>
            <div class="day-focus">
              Teach your dog to look back at you and reconnect.
            </div>
            <ul class="day-steps">
              <li>In a quiet room with the leash on, take a few steps.</li>
              <li>When your dog glances back at you, softly mark it (‚Äúyes‚Äù / ‚Äúnice‚Äù) and reward by your leg.</li>
              <li>Repeat 10‚Äì15 times. You‚Äôre building a habit: checking in is valuable.</li>
            </ul>
          </div>

          <div class="day-block">
            <div class="day-title-row">
              <div class="day-title">Day 3 ‚Äî Loose leash game inside</div>
              <div class="day-time">10‚Äì15 minutes</div>
            </div>
            <div class="day-focus">
              Reward slack leash before you go outside.
            </div>
            <ul class="day-steps">
              <li>Walk slowly around the room. When the leash hangs in a ‚ÄúJ‚Äù shape, reward by your leg.</li>
              <li>If the leash goes tight, stop moving. Wait for your dog to step back or turn, then reward and walk again.</li>
              <li>Keep the tone light ‚Äî this is a game, not a battle.</li>
            </ul>
          </div>

          <div class="day-block">
            <div class="day-title-row">
              <div class="day-title">Day 4 ‚Äî First short outside session</div>
              <div class="day-time">5‚Äì10 minutes</div>
            </div>
            <div class="day-focus">
              Take the indoor game to a quiet outdoor spot.
            </div>
            <ul class="day-steps">
              <li>Pick the calmest area near your home (courtyard, quiet street, parking lot).</li>
              <li>Walk small loops, rewarding slack leash and check-ins.</li>
              <li>End before your dog gets over-excited or tired.</li>
            </ul>
          </div>

          <div class="day-block">
            <div class="day-title-row">
              <div class="day-title">Day 5 ‚Äî Start, stop, start</div>
              <div class="day-time">10‚Äì15 minutes</div>
            </div>
            <div class="day-focus">
              Show your dog that pulling stops the walk, connection restarts it.
            </div>
            <ul class="day-steps">
              <li>On a normal route, walk at a comfortable pace.</li>
              <li>If your dog pulls hard, gently stop and plant your feet.</li>
              <li>When your dog softens the leash or looks back, mark it and walk again.</li>
            </ul>
          </div>

          <div class="day-block">
            <div class="day-title-row">
              <div class="day-title">Day 6 ‚Äî Focus near mild distractions</div>
              <div class="day-time">10‚Äì15 minutes</div>
            </div>
            <div class="day-focus">
              Practice near distant people, cars or dogs.
            </div>
            <ul class="day-steps">
              <li>Stay far enough away that your dog can still think and take treats.</li>
              <li>Reward check-ins and slack leash while the distraction is visible.</li>
              <li>If your dog locks on and can‚Äôt respond, move further away and try again.</li>
            </ul>
          </div>

          <div class="day-block">
            <div class="day-title-row">
              <div class="day-title">Day 7 ‚Äî ‚ÄúChoose you‚Äù game</div>
              <div class="day-time">10 minutes</div>
            </div>
            <div class="day-focus">
              Make you the most interesting part of the walk.
            </div>
            <ul class="day-steps">
              <li>Randomly change direction or speed for a few steps.</li>
              <li>Each time your dog follows and reconnects, reward warmly.</li>
              <li>Keep sessions short and playful, not dizzy or chaotic.</li>
            </ul>
          </div>

          <div class="day-block">
            <div class="day-title-row">
              <div class="day-title">Day 8 ‚Äî Real route rehearsal</div>
              <div class="day-time">15‚Äì20 minutes</div>
            </div>
            <div class="day-focus">
              Use your usual walk route and apply all your tools.
            </div>
            <ul class="day-steps">
              <li>Plan one ‚Äútraining walk‚Äù with extra time, separate from potty needs.</li>
              <li>Use stop/start, check-ins and changes of direction when needed.</li>
              <li>Notice where your dog struggles most and plan extra practice there.</li>
            </ul>
          </div>

          <div class="day-block">
            <div class="day-title-row">
              <div class="day-title">Day 9 ‚Äî Busy-day backup plan</div>
              <div class="day-time">10 minutes</div>
            </div>
            <div class="day-focus">
              Create a version of the walk for days when you‚Äôre tired or rushed.
            </div>
            <ul class="day-steps">
              <li>Choose a shorter, easier route for ‚Äúbusy days‚Äù.</li>
              <li>Focus on one skill only (for example, check-ins) instead of everything.</li>
              <li>End with a simple sniffing break so your dog still feels satisfied.</li>
            </ul>
          </div>

          <div class="day-block">
            <div class="day-title-row">
              <div class="day-title">Day 10 ‚Äî Review & future routine</div>
              <div class="day-time">10‚Äì15 minutes</div>
            </div>
            <div class="day-focus">
              Lock in habits and decide how you‚Äôll maintain them.
            </div>
            <ul class="day-steps">
              <li>Notice how your walks feel compared to Day 1.</li>
              <li>Pick 1‚Äì2 core rules (for example: ‚Äúwe don‚Äôt move forward on a tight leash‚Äù).</li>
              <li>Schedule 1 ‚Äútraining-focused‚Äù walk per week to keep progress strong.</li>
            </ul>
          </div>
        </div>
      </section>

      <section class="section">
        <h2>On days when it feels hopeless</h2>
        <div class="highlight-box">
          <p style="margin-bottom:6px;">
            Every dog-human pair has bad walks. Progress is rarely a straight line.
          </p>
          <ul style="margin-left:16px;margin-bottom:6px;">
            <li>Shorten your walk and lower your expectations that day.</li>
            <li>Celebrate small wins: one calmer corner, one easier passing of a dog.</li>
            <li>Remember: your dog is not trying to annoy you. They‚Äôre excited, curious or anxious.</li>
          </ul>
          <p>
            You can revisit any day of this plan whenever you need a reset.
          </p>
        </div>
      </section>

      <section class="section">
        <h2>Want help with other struggles too?</h2>
        <p>
          If barking at doors or alone-time panic also affect your life, the
          <strong>CalmPaw Complete Pack</strong> combines leash walking, barking
          and separation anxiety plans in one bundle.
        </p>
        <div style="margin-top:8px;">
          <a href="bundle.html" class="btn-primary">View Complete Pack ‚Üí</a>
        </div>
      </section>
    </div>
  </main>

  <footer>
    <div class="footer-inner">
      <div>¬© <span id="year"></span> CalmPaw Coach. All rights reserved.</div>
      <div class="footer-links">
        <a href="refund.html">Refund policy</a>
        <a href="terms.html">Terms of service</a>
        <a href="privacy.html">Privacy policy</a>
        <a href="legal.html">Legal / Imprint</a>
        <a href="contact.html">Contact</a>
      </div>
    </div>
  </footer>

  <script>
    document.getElementById("year").textContent = new Date().getFullYear();

    const API_BASE = "https://calmpaw-auth.sophieinbg.workers.dev";

    // È°∂ÈÉ®ÁôªÂΩïÁä∂ÊÄÅ
    function hydrateNavAuth() {
      const area = document.getElementById("nav-auth-area");
      if (!area) return;

      function renderLoggedOut() {
        const redirect = window.location.pathname + window.location.search;
        area.innerHTML = `
          <a class="btn-outline" href="auth.html?redirect=${encodeURIComponent(redirect)}">
            <span class="nav-login-emoji">üîë</span> Log in
          </a>
        `;
      }

      const token = localStorage.getItem("calmpaw_token");
      const email = localStorage.getItem("calmpaw_email");

      if (!token) {
        renderLoggedOut();
        return;
      }

      fetch(API_BASE + "/auth/me", {
        headers: { "Authorization": "Bearer " + token }
      })
        .then(res => res.json().then(data => ({ ok: res.ok, data })))
        .then(({ ok, data }) => {
          if (!ok || !data.ok) {
            localStorage.removeItem("calmpaw_token");
            localStorage.removeItem("calmpaw_email");
            renderLoggedOut();
            return;
          }
          const showEmail = email || data.email || "Member";
          area.innerHTML = `
            <div class="nav-auth">
              <span class="nav-auth-email" title="${showEmail}">${showEmail}</span>
              <button class="nav-auth-btn" id="nav-switch-account">Switch</button>
              <button class="nav-auth-btn" id="nav-logout">Log out</button>
            </div>
          `;
          const switchBtn = document.getElementById("nav-switch-account");
          if (switchBtn) {
            switchBtn.addEventListener("click", () => {
              localStorage.removeItem("calmpaw_token");
              localStorage.removeItem("calmpaw_email");
              const redirect = window.location.pathname + window.location.search;
              window.location.href = "auth.html?redirect=" + encodeURIComponent(redirect);
            });
          }
          const logoutBtn = document.getElementById("nav-logout");
          if (logoutBtn) {
            logoutBtn.addEventListener("click", () => {
              localStorage.removeItem("calmpaw_token");
              localStorage.removeItem("calmpaw_email");
              window.location.href = "/index.html";
            });
          }
        })
        .catch(err => {
          console.error("auth hydrate error", err);
          renderLoggedOut();
        });
    }

    document.addEventListener("DOMContentLoaded", hydrateNavAuth);

    // ËÆøÈóÆÊéßÂà∂ÔºöÂøÖÈ°ªÁôªÂΩï + Êã•Êúâ leash ËÆ°ÂàíÔºõÂ∏¶ Digistore24 ËÆ¢ÂçïÂèÇÊï∞Êó∂ËΩÆËØ¢ÂêåÊ≠•
    (function () {
      const statusBox = document.getElementById("access-status");
      const paidContent = document.getElementById("paid-content");
      const token = localStorage.getItem("calmpaw_token");

      const search = window.location.search || "";
      const hasOrderParams = /order_id=|transaction_id=/.test(search);
      const POLL_INTERVAL = 3000;
      const MAX_ATTEMPTS_AFTER_ORDER = 40; // ‚âà 2 ÂàÜÈíü
      const MAX_ATTEMPTS_NORMAL = 1;

      function ensureShown() {
        if (!statusBox) return;
        statusBox.style.display = "block";
      }

      function renderLoading() {
        if (!statusBox) return;
        ensureShown();
        statusBox.classList.remove("access-status-ok","access-status-error");
        statusBox.innerHTML = `
          <div class="access-status-row">
            <div class="access-spinner"></div>
            <div>
              Checking your access to the Leash Walking Plan‚Ä¶<br>
              ${hasOrderParams
                ? "We‚Äôre syncing your Digistore24 purchase. This can take up to 1‚Äì2 minutes. Please keep this page open."
                : "Please wait a moment."}
            </div>
          </div>
        `;
      }

      function renderOk() {
        if (!statusBox) return;
        ensureShown();
        statusBox.classList.remove("access-status-error");
        statusBox.classList.add("access-status-ok");
        statusBox.innerHTML = `
          <div class="access-status-row">
            <div>‚úÖ Access confirmed. You can use this page as your permanent access to the 10-day leash plan.</div>
          </div>
        `;
      }

      function renderNoAccessFinal() {
        if (!statusBox) return;
        ensureShown();
        statusBox.classList.remove("access-status-ok");
        statusBox.classList.add("access-status-error");
        statusBox.innerHTML = `
          <div class="access-status-row">
            <div>
              We can't find the Leash Walking Plan on this account yet.<br>
              ${
                hasOrderParams
                  ? "If you just paid via Digistore24 and this page is still locked after a couple of minutes, please contact support with your payment email."
                  : "If you haven‚Äôt purchased this plan yet, please go back to the product page and buy it with the same email you use to log in."
              }
            </div>
          </div>
        `;
      }

      function renderServerError() {
        if (!statusBox) return;
        ensureShown();
        statusBox.classList.remove("access-status-ok");
        statusBox.classList.add("access-status-error");
        statusBox.innerHTML = `
          <div class="access-status-row">
            <div>Server error. Please refresh this page or try again later.</div>
          </div>
        `;
      }

      function renderNeedLogin() {
        if (!statusBox) return;
        ensureShown();
        statusBox.classList.remove("access-status-ok");
        statusBox.classList.add("access-status-error");
        statusBox.innerHTML = `
          <div class="access-status-row">
            <div>Please log in with the same email you used to purchase the Leash Walking Plan.</div>
          </div>
        `;
      }

      function currentRedirect() {
        return window.location.pathname + window.location.search;
      }

      function goAuth() {
        window.location.href = "/auth.html?redirect=" + encodeURIComponent(currentRedirect());
      }

      if (!token) {
        renderNeedLogin();
        goAuth();
        return;
      }

      let attempts = 0;
      const maxAttempts = hasOrderParams ? MAX_ATTEMPTS_AFTER_ORDER : MAX_ATTEMPTS_NORMAL;

      function handleSuccessAccess() {
        if (paidContent) paidContent.style.display = "block";
        renderOk();

        // Ê∏ÖÁêÜ URL ÈáåÁöÑËÆ¢ÂçïÂèÇÊï∞
        if (hasOrderParams) {
          const cleanUrl = window.location.pathname;
          if (cleanUrl) {
            window.history.replaceState(null, "", cleanUrl);
          }
        }
      }

      function poll() {
        if (attempts >= maxAttempts) {
          renderNoAccessFinal();
          return;
        }
        attempts++;
        if (attempts === 1) {
          renderLoading();
        }

        fetch(API_BASE + "/auth/check-plan?slug=leash", {
          method: "GET",
          headers: { Authorization: "Bearer " + token },
        })
          .then(res => res.json().then(data => ({ ok: res.ok, data })))
          .then(({ ok, data }) => {
            if (!ok) {
              localStorage.removeItem("calmpaw_token");
              localStorage.removeItem("calmpaw_email");
              renderNeedLogin();
              goAuth();
              return;
            }

            if (data && data.ok && data.access) {
              handleSuccessAccess();
              return;
            }

            if (attempts >= maxAttempts || !hasOrderParams) {
              renderNoAccessFinal();
            } else {
              setTimeout(poll, POLL_INTERVAL);
            }
          })
          .catch(() => {
            if (hasOrderParams && attempts < maxAttempts) {
              setTimeout(poll, POLL_INTERVAL);
            } else {
              renderServerError();
            }
          });
      }

      poll();
    })();
  </script>
  <footer style="margin-top:40px; padding:20px 0; text-align:center; font-size:12px; color:#8a6a63;">
  <a href="/legal" style="color:#ff914d; text-decoration:none;">Legal Information</a>
</footer>

</body>
</html>
